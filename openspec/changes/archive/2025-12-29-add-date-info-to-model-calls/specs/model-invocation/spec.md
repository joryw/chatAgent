## MODIFIED Requirements
### Requirement: 提示词管理
系统必须（SHALL）提供提示词模板化和格式化能力，用于构建模型输入，并在每次模型调用时自动添加当前日期和时间信息。

#### Scenario: 系统和用户消息格式化
- **WHEN** 应用层提供系统指令和用户查询
- **THEN** 系统将它们格式化为正确的消息结构
- **AND** 维护基于角色的消息顺序
- **AND** 自动在系统消息中添加当前日期信息（格式：YYYY-MM-DD）

#### Scenario: 日期信息自动添加
- **WHEN** 系统准备模型调用时
- **THEN** 系统自动获取当前日期（格式：YYYY-MM-DD）
- **AND** 将日期信息添加到系统消息中
- **AND** 日期信息格式为："当前日期：YYYY-MM-DD"（例如："当前日期：2024-12-26"）

#### Scenario: 提示词模板渲染
- **WHEN** 使用带变量的提示词模板
- **THEN** 系统用实际值替换占位符
- **AND** 生成完整的模型提示词
- **AND** 确保日期信息包含在系统消息中

#### Scenario: 令牌计数
- **WHEN** 准备提示词用于调用
- **THEN** 系统计算提示词中的令牌数（包括日期信息）
- **AND** 在接近上下文窗口限制时发出警告

