# 实施任务清单

## 1. SearXNG 部署文档
- [ ] 1.1 创建 `docs/guides/searxng-deployment.md` 部署指南
  - [ ] Docker 安装说明
  - [ ] docker-compose.yml 配置示例
  - [ ] settings.yml 必要配置说明
  - [ ] 启动和验证步骤
  - [ ] 常见问题排查
- [ ] 1.2 准备 `docker-compose.yml` 模板文件
- [ ] 1.3 准备 `settings.yml` 配置模板

## 2. 配置更新
- [ ] 2.1 更新 `env.example`
  - [ ] 修改 SEARXNG_URL 默认值为 `http://localhost:8080`
  - [ ] 添加配置说明注释
  - [ ] 添加部署文档链接
- [ ] 2.2 更新 `src/config/search_config.py`
  - [ ] 修改默认 searxng_url 为本地地址
  - [ ] 添加 URL 格式验证
  - [ ] 改进配置错误提示

## 3. 健康检查增强
- [ ] 3.1 更新 `src/search/searxng_client.py`
  - [ ] 增强 `health_check()` 方法
  - [ ] 添加 JSON API 可用性检查
  - [ ] 添加配置建议提示
  - [ ] 改进错误日志信息
- [ ] 3.2 添加配置验证方法
  - [ ] 验证 URL 格式
  - [ ] 验证端点可访问性
  - [ ] 验证 JSON 格式支持

## 4. 初始化流程改进
- [ ] 4.1 更新 `app.py`
  - [ ] 改进搜索服务初始化逻辑
  - [ ] 添加配置验证步骤
  - [ ] 优化错误提示信息
  - [ ] 添加部署指引链接
- [ ] 4.2 改进启动提示
  - [ ] 显示 SearXNG 连接状态
  - [ ] 显示配置验证结果
  - [ ] 提供部署帮助信息

## 5. 文档更新
- [ ] 5.1 更新 `README.md`
  - [ ] 添加 SearXNG 部署要求说明
  - [ ] 添加快速部署步骤
  - [ ] 链接到详细部署指南
- [ ] 5.2 更新 `docs/guides/quick-start/README.md`
  - [ ] 添加搜索功能配置章节
  - [ ] 添加 SearXNG 部署说明
- [ ] 5.3 创建 `docs/guides/troubleshooting/searxng.md`
  - [ ] 常见问题和解决方案
  - [ ] 配置验证方法
  - [ ] 日志分析指导

## 6. 测试验证
- [ ] 6.1 测试本地部署流程
  - [ ] 按文档部署 SearXNG
  - [ ] 验证配置正确性
  - [ ] 测试 JSON API 可用性
- [ ] 6.2 测试健康检查功能
  - [ ] 测试正常连接场景
  - [ ] 测试连接失败场景
  - [ ] 测试配置错误场景
- [ ] 6.3 测试降级机制
  - [ ] 搜索服务不可用时的降级
  - [ ] 部分结果失败的处理
  - [ ] 错误提示的准确性
- [ ] 6.4 端到端测试
  - [ ] 完整的搜索流程测试
  - [ ] 不同配置场景测试
  - [ ] 错误恢复测试

## 7. 规范更新
- [ ] 7.1 更新 `openspec/specs/web-search/spec.md`
  - [ ] 应用 delta 变更
  - [ ] 验证规范完整性

## 验收标准

### 功能验收
- [ ] 用户可以按照文档成功部署 SearXNG
- [ ] 系统启动时正确验证 SearXNG 配置
- [ ] 搜索功能正常工作,返回正确结果
- [ ] 搜索失败时正确降级,不影响对话
- [ ] 错误提示清晰,指导用户解决问题

### 文档验收
- [ ] 部署文档完整清晰,步骤可执行
- [ ] 配置示例准确可用
- [ ] 故障排查文档覆盖常见问题
- [ ] README 中有明确的部署指引

### 代码质量
- [ ] 代码遵循项目规范
- [ ] 日志信息清晰有用
- [ ] 错误处理健全
- [ ] 无遗留的公共 API 引用

