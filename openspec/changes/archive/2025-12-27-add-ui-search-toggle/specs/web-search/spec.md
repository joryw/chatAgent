## MODIFIED Requirements

### Requirement: 搜索开关控制
系统 SHALL 在聊天界面提供联网搜索开关,允许用户通过UI控件或命令两种方式启用或禁用搜索功能。

#### Scenario: 通过UI开关启用搜索
- **WHEN** 用户在聊天设置面板中打开"联网搜索"开关
- **THEN** 系统将在后续对话中启用搜索功能
- **AND** 系统发送消息确认"联网搜索 ✅ 已启用"
- **AND** UI开关显示为开启状态

#### Scenario: 通过UI开关禁用搜索
- **WHEN** 用户在聊天设置面板中关闭"联网搜索"开关
- **THEN** 系统将在后续对话中禁用搜索功能
- **AND** 系统发送消息确认"联网搜索 ❌ 已禁用"
- **AND** UI开关显示为关闭状态

#### Scenario: 通过命令启用搜索
- **WHEN** 用户发送 `/search on` 命令
- **THEN** 系统启用搜索功能
- **AND** 系统发送确认消息
- **AND** UI开关状态同步更新为开启

#### Scenario: 通过命令禁用搜索
- **WHEN** 用户发送 `/search off` 命令
- **THEN** 系统禁用搜索功能
- **AND** 系统发送确认消息
- **AND** UI开关状态同步更新为关闭

#### Scenario: 默认状态
- **WHEN** 用户首次进入聊天界面
- **THEN** 搜索开关默认为关闭状态
- **AND** UI控件显示为关闭
- **AND** 欢迎消息中说明搜索开关的位置和用法

#### Scenario: 搜索服务不可用时的UI状态
- **WHEN** SearXNG 搜索服务不可用或未配置
- **THEN** UI开关显示为禁用状态(灰色/不可点击)
- **AND** 开关的描述文本说明"搜索服务不可用"
- **AND** 欢迎消息中显示配置指南链接
- **AND** 用户尝试通过命令启用搜索时收到不可用提示

#### Scenario: UI和命令状态同步
- **WHEN** 用户通过任一方式(UI或命令)修改搜索状态
- **THEN** 另一种方式的状态显示应当立即同步
- **AND** `/config` 命令显示的状态与UI开关一致
- **AND** 实际搜索行为与显示的状态一致

## ADDED Requirements

### Requirement: 聊天设置面板
系统 SHALL 提供聊天设置面板,允许用户通过UI控件配置聊天功能。

#### Scenario: 设置面板初始化
- **WHEN** 用户会话开始时
- **THEN** 系统应当创建并显示聊天设置面板
- **AND** 设置面板包含"联网搜索"开关控件
- **AND** 设置面板位于聊天界面的固定位置(如侧边栏或顶部)

#### Scenario: 设置面板可访问性
- **WHEN** 用户需要修改设置
- **THEN** 设置面板应当始终可访问
- **AND** 不会被聊天消息遮挡
- **AND** 在移动端设备上也能正常显示和操作

#### Scenario: 搜索开关控件
- **WHEN** 设置面板显示时
- **THEN** 搜索开关控件应当包含:
  - 图标: 🔍 (搜索图标)
  - 标签: "联网搜索"
  - 描述: "启用后将使用SearXNG搜索实时信息"
  - 开关状态: 开启/关闭/禁用
- **AND** 控件状态清晰可辨

#### Scenario: 实时状态更新
- **WHEN** 用户切换UI开关
- **THEN** 系统应当立即响应状态变化
- **AND** 在500毫秒内发送状态确认消息
- **AND** 后续消息立即按新状态处理


